function  M=ECDF_McD(p,dim,h)
n=dim;
e=ones(n,1);
switch p
    case 2 
        A = spdiags([e, -2*e, e], 0:2, n, n+2);
        v0=-(2/3)*[2, -1/2, zeros(1,n-2)];
        vf=(2/3)*[ zeros(1,n-2), 1/2 -2];
    case 4
        A = spdiags([-e/12, 4*e/3, -5*e/2, 4*e/3, -e/12], -1:3, n, n+2);
        A(1,1:5)=[11/12, -5/3, 1/2 1/3 -1/12];
        A(n,n-2:n+2)=fliplr([11/12, -5/3, 1/2 1/3 -1/12]);
        v0=(-12/25)*[ 4, -3, 4/3, -1/4,  zeros(1,n-4)];
        vf=(12/25)*[ zeros(1,n-4), 1/4, -4/3,   3, -4];
    case 6
        C6=[     203/45         137/180        -13/180          1/90           1/90         -13/180        137/180;   
        -87/5          -49/60          19/15          -3/20          -1/15          31/60         -27/5;     
        117/4          -17/12          -7/3            3/2            1/12         -19/12          33/2 ;    
        -254/9           47/18          10/9          -49/18          10/9           47/18        -254/9 ;    
        33/2          -19/12           1/12           3/2           -7/3          -17/12         117/4  ;   
        -27/5           31/60          -1/15          -3/20          19/15         -49/60         -87/5  ;   
        137/180        -13/180          1/90           1/90         -13/180        137/180        203/45 ];
        A = spdiags([e/90, -3*e/20, 3*e/2, -49*e/18, 3*e/2 -3*e/20, e/90], -2:4, n, n+2);
        A(1,1:7)=C6(:,2)';
        A(2,1:7)=C6(:,3)';
        A(n-1,n-4:n+2)=C6(:,5)';
        A(n,n-4:n+2)=C6(:,6)';
        v0=(-20/49)*[ 6, -15/2 , 20/3, -15/4, 6/5,    -1/6, zeros(1,n-6)];
        vf=(20/49)*[ zeros(1,n-6), 1/6, -6/5,    15/4,  -20/3,   15/2, -6];
end
%II=speye(n);
A=full(A);
A=h^(-2)*(A);
M = A(:,2:n+1);
bcNeu =-(kron(A(:,1),v0)+ kron(A(:,end),vf));
M = M+bcNeu;